!function(e){e.queryLoader2=function(o,n){var t=this;t.$el=e(o),t.el=o,t.$el.data("queryLoader2",t),t.qLimageContainer="",t.qLoverlay="",t.qLbar="",t.qLpercentage="",t.qLimages=[],t.qLbgimages=[],t.qLimageCounter=0,t.qLdone=0,t.qLdestroyed=!1,t.init=function(){t.options=e.extend({},e.queryLoader2.defaultOptions,n),t.findImageInElement(t.el),1==t.options.deepSearch&&t.$el.find("*:not(script)").each(function(){t.findImageInElement(this)}),t.createPreloadContainer(),t.createOverlayLoader()},t.createPreloadContainer=function(){t.qLimageContainer=e("<div></div>").appendTo("body").css({display:"none",width:0,height:0,overflow:"hidden"});for(var o=0;t.qLbgimages.length>o;o++)e.ajax({url:t.qLbgimages[o],type:"HEAD",complete:function(e){t.qLdestroyed||t.addImageForPreload(this.url)}})},t.addImageForPreload=function(o){var n=e("<img />").attr("src",o);t.bindLoadEvent(n),n.appendTo(t.qLimageContainer)},t.createOverlayLoader=function(){var o="absolute";"BODY"==t.$el.prop("tagName")?o="fixed":t.$el.css("position","relative"),t.qLoverlay=e("<div id='"+t.options.overlayId+"'></div>").css({width:"100%",height:"100%",backgroundColor:t.options.backgroundColor,backgroundPosition:"fixed",position:o,zIndex:666999,top:0,left:0}).appendTo(t.$el),0==t.options.loadingBar&&t.qLoverlay.hide(),t.qLbar=e("<div id='qLbar'></div>").css({height:t.options.barHeight+"px",marginTop:"-"+t.options.barHeight/2+"px",backgroundColor:t.options.barColor,width:"0%",position:"absolute",top:"50%"}).appendTo(t.qLoverlay),1==t.options.percentage&&(t.qLpercentage=e("<div id='qLpercentage'></div>").text("0%").css({height:"40px",width:"100px",position:"absolute",fontSize:"3em",top:"50%",left:"50%",marginTop:"-"+(59+t.options.barHeight)+"px",textAlign:"center",marginLeft:"-50px",color:t.options.barColor}).appendTo(t.qLoverlay)),(!t.qLimages.length||0==t.qLimageCounter&&0==t.qLbgimages.length)&&t.endLoader()},t.destroyContainers=function(){t.qLdestroyed=!0,t.qLimageContainer.remove(),t.qLoverlay.remove()},t.findImageInElement=function(o){var n="",a=e(o),i="normal";if("none"!=a.css("background-image")?(n=a.css("background-image"),i="background"):"undefined"!=typeof a.attr("src")&&"img"==o.nodeName.toLowerCase()&&(n=a.attr("src")),-1==n.indexOf("gradient")){n=n.replace(/url\(\"/g,""),n=n.replace(/url\(/g,""),n=n.replace(/\"\)/g,""),n=n.replace(/\)/g,"");for(var r=n.split(", "),d=0;d<r.length;d++)if(r[d].length>0&&-1==t.qLimages.indexOf(r[d])&&!r[d].match(/^(data:)/i)){var s="";t.isIE()||t.isOpera()?(s="?rand="+Math.random(),t.qLbgimages.push(r[d]+s)):"background"==i?t.qLbgimages.push(r[d]):t.bindLoadEvent(a),t.qLimages.push(r[d])}}},t.isIE=function(){return navigator.userAgent.match(/msie/i)},t.isOpera=function(){return navigator.userAgent.match(/Opera/i)},t.bindLoadEvent=function(e){e[0].complete||(t.qLimageCounter++,e.bind("load error",function(){t.completeImageLoading(this)}))},t.completeImageLoading=function(e){t.qLdone++;var o=t.qLdone/t.qLimageCounter*100;t.qLbar.stop().animate({width:o+"%",minWidth:o+"%"},200),1==t.options.percentage&&t.qLpercentage.text(Math.ceil(o)+"%"),t.qLdone==t.qLimageCounter&&t.endLoader()},t.endLoader=function(){t.qLdestroyed=!0,t.onLoadComplete()},t.onLoadComplete=function(){if(1==t.options.percentage&&t.qLpercentage.text("100%"),"grow"==t.options.completeAnimation){var o=500;t.qLbar.stop().animate({width:"100%"},o,function(){e(this).animate({top:"0%",width:"100%",height:"100%"},500,function(){e("#"+t.options.overlayId).fadeOut(500,function(){e(this).remove(),t.destroyContainers(),t.options.onComplete()})})})}else e("#"+t.options.overlayId).fadeOut(500,function(){e("#"+t.options.overlayId).remove(),t.destroyContainers(),t.options.onComplete()})},t.init()},e.queryLoader2.defaultOptions={onComplete:function(){},backgroundColor:"#000",barColor:"#fff",overlayId:"qLoverlay",barHeight:1,loadingBar:!0,percentage:!1,deepSearch:!0,completeAnimation:"fade",minimumTime:500},e.fn.queryLoader2=function(o){return this.each(function(){new e.queryLoader2(this,o)})}}(jQuery),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var o=this.length>>>0,n=Number(arguments[1])||0;for(n=0>n?Math.ceil(n):Math.floor(n),0>n&&(n+=o);o>n;n++)if(n in this&&this[n]===e)return n;return-1});